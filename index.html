<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OG Image Studio • One‑File (Dual Export)</title>
  <meta name="description" content="Gere imagens OG (1200×630) direto no navegador: título, subtítulo, logo com posição livre (arraste), tema claro/escuro, gradiente e exporte PNG (uma ou duas variantes) — tudo em um único HTML." />
  <style>
    :root{ --bg:#0b0c0f; --panel:#141720; --soft:#1b2030; --text:#eef1f5; --muted:#a9b2c3; --accent:#6ee7ff; --ring:#2a3348; }
    @media (prefers-color-scheme: light) { :root{ --bg:#f5f7fb; --panel:#ffffff; --soft:#eef2f9; --text:#0b1220; --muted:#5b6475; --accent:#006dff; --ring:#cfd8ea; } }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 800px at 10% -10%, rgba(110,231,255,.08), transparent 60%), radial-gradient(800px 600px at 100% 0%, rgba(0,109,255,.08), transparent 60%), var(--bg); color:var(--text); font:500 15px/1.5 system-ui,-apple-system,Segoe UI,Roboto}
    .wrap{max-width:1200px;margin-inline:auto;padding:16px}
    header{position:sticky;top:0;z-index:5;backdrop-filter:saturate(1.2) blur(6px);background:color-mix(in oklab,var(--bg) 80%, transparent)}
    .title{font-size:clamp(22px,4vw,28px);font-weight:800}

    .toolbar{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .panel{background:var(--panel);border:1px solid var(--ring);border-radius:14px;padding:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    label{display:flex;align-items:center;gap:6px}
    input[type="text"], input[type="number"], input[type="color"], select{padding:8px;border-radius:10px;border:1px solid var(--ring);background:var(--panel);color:var(--text)}
    .btn{padding:8px 12px;border-radius:12px;border:1px solid var(--ring);background:var(--soft);color:var(--text);cursor:pointer}
    .hint{color:var(--muted);font-size:13px}

    .stage{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
    canvas{width:100%;max-width:100%;height:auto;display:block;border-radius:16px;border:1px dashed var(--ring);background:#000}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="title">OG Image Studio • One‑File</div>
      <div class="toolbar">
        <div class="panel">
          <div class="row"><label>Título <input id="title" type="text" placeholder="Seu título incrível" size="28"></label></div>
          <div class="row"><label>Subtítulo <input id="subtitle" type="text" placeholder="Uma frase curta opcional" size="32"></label></div>
          <div class="row">
            <label>Tema
              <select id="theme">
                <option value="dark">Escuro</option>
                <option value="light">Claro</option>
              </select>
            </label>
            <label>Layout
              <select id="layout">
                <option value="left">Texto à esquerda</option>
                <option value="center">Centralizado</option>
                <option value="banner">Banner</option>
              </select>
            </label>
            <label>Tam. Título <input id="titleSize" type="number" value="96" min="24" max="160" style="width:90px"></label>
          </div>
          <div class="row">
            <label>Cor destaque <input id="accent" type="color" value="#6ee7ff"></label>
            <label>Gradiente A <input id="g1" type="color" value="#0b0c0f"></label>
            <label>Gradiente B <input id="g2" type="color" value="#1b2030"></label>
            <label>Brilho <input id="glow" type="number" value="140" min="0" max="400" style="width:80px"></label>
          </div>
          <div class="row">
            <label>Tamanho <select id="size">
              <option value="1200x630">1200 × 630 (OG padrão)</option>
              <option value="1600x900">1600 × 900</option>
              <option value="1920x1005">1920 × 1005</option>
            </select></label>
            <label>Arquivo <input id="filename" type="text" value="og.png" size="16"></label>
          </div>
          <div class="row">
            <input id="logo" type="file" accept="image/*" class="btn"> 
            <label>Tam. logo <input id="logoSize" type="number" value="160" min="64" max="360" style="width:80px"></label>
            <label><input id="logoCircle" type="checkbox" checked> Máscara circular</label>
          </div>
          <div class="row">
            <label><input id="logoFree" type="checkbox"> Posição livre (arraste no canvas)</label>
            <label>Preset
              <select id="logoPreset">
                <option value="auto" selected>Auto (por layout)</option>
                <option value="tl">Topo‑esquerda</option>
                <option value="tr">Topo‑direita</option>
                <option value="bl">Baixo‑esquerda</option>
                <option value="br">Baixo‑direita</option>
                <option value="center">Centro</option>
              </select>
            </label>
            <button class="btn" id="resetLogo">Resetar logo</button>
          </div>
        </div>
        <div class="panel">
          <div class="row">
            <button class="btn" id="export">Exportar PNG</button>
            <button class="btn" id="exportBoth">Exportar 2 variantes</button>
            <button class="btn" id="copyMeta">Copiar meta OG</button>
            <button class="btn" id="randomize">Surpreenda‑me</button>
          </div>
          <p class="hint">Dica: carregue sua logo (PNG transparente), ajuste cores e baixe. Marque <b>Posição livre</b> para <b>arrastar</b> o logo no canvas. “Exportar 2 variantes” baixa dark e light de uma vez.</p>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap stage">
    <canvas id="cnv" width="1200" height="630" aria-label="Prévia 1200×630"></canvas>
  </main>

  <script>
  const s={ title:'Seu título incrível', subtitle:'Uma frase curta opcional', theme:'dark', layout:'left', titleSize:96, accent:'#6ee7ff', g1:'#0b0c0f', g2:'#1b2030', glow:140, w:1200, h:630, logo:null, logoSize:160, logoCircle:true, filename:'og.png', logoFree:false, logoPreset:'auto', logoX:null, logoY:null, dragging:false, dragDX:0, dragDY:0, logoBox:null }
  const el={
    title:document.getElementById('title'), subtitle:document.getElementById('subtitle'), theme:document.getElementById('theme'), layout:document.getElementById('layout'), titleSize:document.getElementById('titleSize'), accent:document.getElementById('accent'), g1:document.getElementById('g1'), g2:document.getElementById('g2'), glow:document.getElementById('glow'), size:document.getElementById('size'), logo:document.getElementById('logo'), logoSize:document.getElementById('logoSize'), logoCircle:document.getElementById('logoCircle'), filename:document.getElementById('filename'), logoFree:document.getElementById('logoFree'), logoPreset:document.getElementById('logoPreset'), resetLogo:document.getElementById('resetLogo'), export:document.getElementById('export'), exportBoth:document.getElementById('exportBoth'), copyMeta:document.getElementById('copyMeta'), random:document.getElementById('randomize')
  }
  const dpr=window.devicePixelRatio||1; const cv=document.getElementById('cnv'); const ctx=cv.getContext('2d');

  function setCanvasSize(w,h){ cv.width=Math.round(w*dpr); cv.height=Math.round(h*dpr); cv.style.width=w+'px'; cv.style.height=h+'px'; ctx.setTransform(dpr,0,0,dpr,0,0); cv.setAttribute('aria-label',`Prévia ${w}×${h}`) }

  function hexToRgb(hex){hex=hex.replace('#',''); if(hex.length===3) hex=[...hex].map(c=>c+c).join(''); const num=parseInt(hex,16); return {r:(num>>16)&255,g:(num>>8)&255,b:num&255}}
  function rgb(r,g,b,a=1){return `rgba(${r},${g},${b},${a})`}

  function wrapText(text, maxWidth, font){ ctx.save(); ctx.font=font; const words=text.split(/\s+/); const lines=[]; let line=''; for(const w of words){ const test=line? line+' '+w : w; if(ctx.measureText(test).width<=maxWidth){ line=test } else { if(line) lines.push(line); line=w } } if(line) lines.push(line); ctx.restore(); return lines }

  function layoutLogo(W,H,logoPx){
    const pad=56; const lm=s.logoPreset; let lx=pad, ly=pad;
    if(s.logoFree && s.logoX!=null && s.logoY!=null){ lx=s.logoX; ly=s.logoY; }
    else if(lm==='tl'){ lx=pad; ly=pad }
    else if(lm==='tr'){ lx=W - pad - logoPx; ly=pad }
    else if(lm==='bl'){ lx=pad; ly=H - pad - logoPx }
    else if(lm==='br'){ lx=W - pad - logoPx; ly=H - pad - logoPx }
    else if(lm==='center'){ lx=(W-logoPx)/2; ly=(H-logoPx)/2 }
    else { // auto por layout
      if(s.layout==='center'){ lx=(W-logoPx)/2; ly=pad }
      else if(s.layout==='banner'){ lx=pad; ly=(H-logoPx)/2 }
      else { lx=W - pad - logoPx; ly=pad }
    }
    // Clamp
    lx=Math.max(0, Math.min(W-logoPx, lx)); ly=Math.max(0, Math.min(H-logoPx, ly));
    return {lx,ly}
  }

  function draw(){
    const W=cv.width/dpr, H=cv.height/dpr; // trabalhar em px CSS
    ctx.clearRect(0,0,W,H);
    const dark=s.theme==='dark'; const g1=dark? s.g1 : '#f5f7fb'; const g2=dark? s.g2 : '#e8eef9'; const textCol=dark? '#eef1f5':'#0b1220'; const mut=dark? '#a9b2c3':'#5b6475';
    const grad=ctx.createLinearGradient(0,0,W,H); grad.addColorStop(0,g1); grad.addColorStop(1,g2); ctx.fillStyle=grad; ctx.fillRect(0,0,W,H);
    const acc=hexToRgb(s.accent); const glow=Math.max(0,Math.min(400, Number(s.glow)||0));
    const rg=ctx.createRadialGradient(W*0.75, H*0.25, 10, W*0.75, H*0.25, glow);
    rg.addColorStop(0, rgb(acc.r,acc.g,acc.b, .35)); rg.addColorStop(1, rgb(acc.r,acc.g,acc.b, 0));
    ctx.fillStyle=rg; ctx.fillRect(0,0,W,H);

    const pad=56; const innerW=W - pad*2; const innerH=H - pad*2;

    // LOGO
    const L=s.logo; const logoPx=Math.min(innerH, Math.max(32, s.logoSize)); const {lx,ly}=layoutLogo(W,H,logoPx); if(s.logoFree){ s.logoX=lx; s.logoY=ly }
    if(L){ ctx.save(); if(s.logoCircle){ ctx.beginPath(); ctx.arc(lx+logoPx/2,ly+logoPx/2,logoPx/2,0,Math.PI*2); ctx.closePath(); ctx.clip(); } ctx.drawImage(L, lx, ly, logoPx, logoPx); ctx.restore(); s.logoBox={x:lx,y:ly,w:logoPx,h:logoPx}; }

    // TEXTOS
    const title=s.title.trim()||'Título'; const sub=s.subtitle.trim();
    const titlePx=Math.max(24, Math.min(160, Number(s.titleSize)||96)); const subPx=Math.round(titlePx*0.38);
    const family='-apple-system, Segoe UI, Roboto, Inter, system-ui, sans-serif';
    ctx.fillStyle=textCol; ctx.textBaseline='top'; ctx.textAlign='left';

    let textX=pad, textY=pad; let textW=innerW;
    if(s.layout==='center'){ textX=pad; textY=(s.logoBox? (s.logoBox.y+s.logoBox.h+24) : pad); textW=W-pad*2 }
    if(s.layout==='left' && s.logoBox){ textW = innerW - (s.logoBox.w + 28) }
    if(s.layout==='banner'){ textX = (s.logoBox? s.logoBox.x + s.logoBox.w + 24 : pad); textY = pad; textW = W - textX - pad }

    ctx.font=`800 ${titlePx}px ${family}`; const lines=wrapText(title, textW, ctx.font); let y=textY; for(const ln of lines){ ctx.fillText(ln, textX, y); y += titlePx*1.05 }
    if(sub){ ctx.fillStyle=mut; ctx.font=`600 ${subPx}px ${family}`; const slines=wrapText(sub, textW, ctx.font); for(const ln of slines){ ctx.fillText(ln, textX, y); y += subPx*1.2 } }

    // barra de acento
    ctx.fillStyle=rgb(acc.r,acc.g,acc.b,.9); const barH=Math.max(6, Math.round(titlePx*0.07)); ctx.fillRect(pad, H - pad - barH, W - pad*2, barH)
  }

  // Eventos UI
  function bind(){
    el.title.addEventListener('input',e=>{ s.title=e.target.value; draw() });
    el.subtitle.addEventListener('input',e=>{ s.subtitle=e.target.value; draw() });
    el.theme.addEventListener('change',e=>{ s.theme=e.target.value; draw() });
    el.layout.addEventListener('change',e=>{ s.layout=e.target.value; draw() });
    el.titleSize.addEventListener('input',e=>{ s.titleSize=+e.target.value; draw() });
    el.accent.addEventListener('input',e=>{ s.accent=e.target.value; draw() });
    el.g1.addEventListener('input',e=>{ s.g1=e.target.value; draw() });
    el.g2.addEventListener('input',e=>{ s.g2=e.target.value; draw() });
    el.glow.addEventListener('input',e=>{ s.glow=+e.target.value; draw() });
    el.logoSize.addEventListener('input',e=>{ s.logoSize=+e.target.value; draw() });
    el.logoCircle.addEventListener('change',e=>{ s.logoCircle=e.target.checked; draw() });
    el.logoFree.addEventListener('change', e=>{ s.logoFree=e.target.checked; if(!s.logoFree){ s.logoX=null; s.logoY=null } draw() });
    el.logoPreset.addEventListener('change', e=>{ s.logoPreset=e.target.value; if(s.logoFree){ s.logoX=null; s.logoY=null } draw() });
    el.resetLogo.addEventListener('click', ()=>{ s.logoX=null; s.logoY=null; s.logoFree=false; el.logoFree.checked=false; s.logoPreset='auto'; el.logoPreset.value='auto'; draw() });

    el.size.addEventListener('change', e=>{ const [w,h]=e.target.value.split('x').map(n=>+n); s.w=w; s.h=h; setCanvasSize(w,h); draw() });

    el.logo.addEventListener('change', e=>{ const f=e.target.files?.[0]; if(!f) return; const r=new FileReader(); const img=new Image(); r.onload=()=>{ img.onload=()=>{ s.logo=img; // posição inicial
          if(s.logoFree){ s.logoX=null; s.logoY=null } draw() }; img.src=r.result }; r.readAsDataURL(f) })

    el.export.addEventListener('click', ()=>{ downloadPNG(s.filename||'og.png') })
    el.exportBoth.addEventListener('click', ()=>{ exportBoth() })

    el.copyMeta.addEventListener('click', async ()=>{
      const meta = `<!-- Open Graph -->\n<meta property="og:image" content="${s.filename||'og.png'}"/>\n<meta property="og:image:width" content="${s.w}"/>\n<meta property="og:image:height" content="${s.h}"/>\n<meta name="twitter:card" content="summary_large_image"/>`;
      try{ await navigator.clipboard.writeText(meta); alert('Trecho meta OG copiado!'); }catch(e){ prompt('Copie o trecho abaixo:', meta) }
    })

    el.random.addEventListener('click', ()=>{
      const presets=[
        {g1:'#0b0c0f',g2:'#1b2030',accent:'#6ee7ff',theme:'dark'},
        {g1:'#0b1220',g2:'#1b2a4a',accent:'#58a6ff',theme:'dark'},
        {g1:'#fafcff',g2:'#e8eef9',accent:'#006dff',theme:'light'},
        {g1:'#111827',g2:'#0f172a',accent:'#34d399',theme:'dark'},
        {g1:'#fff7ed',g2:'#fde68a',accent:'#fb923c',theme:'light'}
      ]; Object.assign(s, presets[Math.floor(Math.random()*presets.length)]); el.theme.value=s.theme; el.g1.value=s.g1; el.g2.value=s.g2; el.accent.value=s.accent; draw();
    })
  }

  // Canvas – arrastar logo quando posição livre
  function canvasPos(e){ const r=cv.getBoundingClientRect(); return { x:(e.clientX-r.left)*(cv.width/r.width)/dpr, y:(e.clientY-r.top)*(cv.height/r.height)/dpr } }
  cv.addEventListener('mousemove', e=>{ if(!s.logoFree||!s.logoBox) return; const p=canvasPos(e); const over = p.x>=s.logoBox.x && p.x<=s.logoBox.x+s.logoBox.w && p.y>=s.logoBox.y && p.y<=s.logoBox.y+s.logoBox.h; cv.style.cursor = (over||s.dragging)? (s.dragging?'grabbing':'grab') : 'default'; if(s.dragging){ s.logoX = Math.max(0, Math.min(cv.width/dpr - s.logoBox.w, p.x - s.dragDX)); s.logoY = Math.max(0, Math.min(cv.height/dpr - s.logoBox.h, p.y - s.dragDY)); draw() } })
  cv.addEventListener('mousedown', e=>{ if(!s.logoFree||!s.logoBox) return; const p=canvasPos(e); if(p.x>=s.logoBox.x && p.x<=s.logoBox.x+s.logoBox.w && p.y>=s.logoBox.y && p.y<=s.logoBox.y+s.logoBox.h){ s.dragging=true; s.dragDX=p.x-s.logoBox.x; s.dragDY=p.y-s.logoBox.y; } })
  window.addEventListener('mouseup', ()=>{ s.dragging=false })

  // Export helpers
  function downloadPNG(name){ const a=document.createElement('a'); a.href=cv.toDataURL('image/png'); a.download=name; a.click() }
  function withTheme(tmpTheme, fn){ const cur=s.theme; s.theme=tmpTheme; el.theme.value=tmpTheme; draw(); try{ fn() } finally { s.theme=cur; el.theme.value=cur; draw() } }
  function exportBoth(){ const base=(s.filename||'og.png'); const dot=base.lastIndexOf('.'); const root = dot>0? base.slice(0,dot) : base; const ext = dot>0? base.slice(dot) : '.png'; const darkName = root.match(/light/i)? root.replace(/light/i,'dark')+ext : root+(root.toLowerCase().includes('dark')?'': '-dark')+ext; const lightName = root.match(/dark/i)? root.replace(/dark/i,'light')+ext : root+(root.toLowerCase().includes('light')?'': '-light')+ext; withTheme('dark', ()=> downloadPNG(darkName)); withTheme('light', ()=> downloadPNG(lightName)); }

  // init
  function init(){ setCanvasSize(s.w, s.h); bind(); draw(); }
  init()
  </script>
</body>
</html>
